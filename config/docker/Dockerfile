##########################################################################
# Base image begin
##########################################################################
FROM devkirin/abt-server:latest
##########################################################################
# Base image end
##########################################################################



##########################################################################
# ENV VAR begin
##########################################################################
ARG RAILS_ENV=development
ENV DEBIAN_FRONTEND noninteractive
##########################################################################
# ENV VAR end
##########################################################################



##########################################################################
# Setup app begin
# Private stuff below, do not include for building base image
# Below adds app code to the image, so do not include in public image
##########################################################################
# copy src code
COPY . /app/ABT-server

# install gems
RUN bundle install

# compile assets
RUN RAILS_ENV=$RAILS_ENV rails assets:precompile
##########################################################################
# Setup app end
##########################################################################



##########################################################################
# Starting commands begin
##########################################################################
# start null service
CMD ["tail", "-f", "/dev/null"]

# start web service
# CMD ["rails", "s", "-p", "3000"]
##########################################################################
# Starting commands end
##########################################################################

